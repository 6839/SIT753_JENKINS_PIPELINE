pipeline {
    agent any
    stages {
        stage("Build") {
            steps {
                echo "Building the code via Maven..."
            }
        }
        stage("Tests") {
            steps {
                echo "Running tests via JUnit..."
            }
            
            post {
                success {
                    script {
                        emailext (
							subject: "Tests Passed",
							body: "All tests passed successfully.",
                            to: "zhijianmin8@gmail.com",
                            attachLog: true,
                            mimeType: 'text/html'
                        )
                    }
                }
                failure {
                    script {
                        emailext (
							subject: "Tests Failed",
                            body: "Some tests failed. See attached logs.",
							to: "zhijianmin8@gmail.com",
                            attachLog: true,
                            mimeType: 'text/html'
                        )
                    }
                }
            }
            
        }
        stage("Security Scan") {
            steps {
                echo "Performing security scan on the code via OWASP ZAP..."
            }
			
            post {
                success {
                    script {
                        emailext (
							subject: "Security Scan Passed",
							body: "All Security Scan passed successfully.",
                            to: "zhijianmin8@gmail.com",
                            attachLog: true,
                            mimeType: 'text/html'
                        )
                    }
                }
                failure {
                    script {
                        emailext (
							subject: "Security Scan Failed",
                            body: "Some Security Scan failed. See attached logs.",
							to: "zhijianmin8@gmail.com",
                            attachLog: true,
                            mimeType: 'text/html'
                        )
                    }
                }
            }
        }
    }
}
